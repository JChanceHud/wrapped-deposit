# Wrapped Deposit

A method of depositing ERC20 tokens with fewer transactions and less risk.

## How it works

A user approves the wrapped deposit token to spend tokens on their behalf. Applications needing to accept deposits implement the following function:

```js
function acceptDeposit(address depositor, address token, uint amount) returns (bool);
```

Applications then have the user send a transaction to the deposit wrapper like this:
```js
// to is the application address
depositToken(address to, address token, uint amount);
```

## Difference from existing models

### Current model

The user must first approve an application to spend tokens on their behalf. Then the user sends a second transaction asking the application to send tokens to itself from the user. This is necessary so the application can perform deposit logic, like updating the deposit balance for the user.

<svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 749.5181494509441 762.2738095238096" width="500">
  <!-- svg-source:excalidraw -->
  <defs>
    <style>
      @font-face {
        font-family: "Virgil";
        src: url("https://plus.excalidraw.com/Virgil.woff2");
      }
      @font-face {
        font-family: "Cascadia";
        src: url("https://plus.excalidraw.com/Cascadia.woff2");
      }
    </style>
  </defs>
  <rect x="0" y="0" width="749.5181494509441" height="762.2738095238096" fill="#ffffff"></rect><g stroke-linecap="round" transform="translate(29.946720879515624 408) rotate(0 37.5 37.5)"><path d="M27.49 0.71 C34.36 -1.99, 44.35 -1.48, 51.21 1.38 C58.06 4.24, 64.7 11.43, 68.61 17.87 C72.51 24.31, 74.92 32.65, 74.63 40.02 C74.33 47.39, 71.66 56.57, 66.85 62.11 C62.04 67.66, 53.15 71.67, 45.76 73.28 C38.37 74.88, 29.31 74.7, 22.52 71.75 C15.73 68.81, 8.88 62.05, 5.02 55.61 C1.16 49.16, -1.52 40.55, -0.65 33.09 C0.23 25.63, 4.58 16.24, 10.27 10.83 C15.96 5.43, 28.28 2.39, 33.49 0.66 C38.69 -1.07, 41.42 0.05, 41.52 0.45 M22.42 2.13 C28.56 -1.02, 37.5 -0.48, 44.87 1.18 C52.24 2.84, 61.82 6.21, 66.66 12.09 C71.5 17.97, 73.41 28.86, 73.91 36.44 C74.41 44.01, 73.74 51.47, 69.65 57.54 C65.56 63.61, 56.79 70.36, 49.36 72.85 C41.93 75.33, 32.38 74.88, 25.09 72.46 C17.8 70.04, 9.84 64.2, 5.63 58.34 C1.42 52.47, -0.68 44.57, -0.18 37.27 C0.31 29.97, 4.78 20.24, 8.61 14.53 C12.45 8.82, 20.41 4.68, 22.83 2.99 C25.25 1.31, 23.05 3.7, 23.14 4.4" stroke="#000000" stroke-width="1" fill="none"></path></g><g stroke-linecap="round"><g transform="translate(66.94672087951562 484) rotate(0 -0.4479284981257905 59.41382885895203)"><path d="M0.6 -0.71 C0.48 18.9, -0.42 98.4, -0.33 118 M-0.55 1.53 C-0.89 21.32, -1.7 100.19, -1.45 119.54" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g transform="translate(67.94672087951562 598) rotate(0 -28.415137543966992 28.29100916131867)"><path d="M-0.71 -0.33 C-10.26 9.26, -47.43 48.38, -57 58.13 M1.12 -1.55 C-8.62 7.68, -48.46 46.94, -57.95 56.6" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g transform="translate(67.94672087951562 600) rotate(0 26.899806240200995 25.902617284944284)"><path d="M-0.33 0 C8.59 8.77, 45.05 43.23, 54.13 51.89 M1.7 -1.04 C10.51 7.89, 45.06 43.88, 53.77 52.85" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g transform="translate(68.94672087951562 535) rotate(0 -22.05297925770283 -12.121347330813279)"><path d="M0 1.13 C-7.23 -2.79, -36.77 -19.45, -44.11 -23.85 M-1.46 0.67 C-8.27 -3.52, -35.27 -21.24, -41.98 -25.37" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g transform="translate(69.94672087951562 535) rotate(0 31.704575444464574 -8.548720250655919)"><path d="M1.13 -1.11 C11.71 -4.11, 53.05 -15.56, 63.15 -18.02 M0.26 0.93 C10.81 -1.96, 52.72 -13.93, 62.8 -17.02" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round" transform="translate(483.51814945094407 380.57142857142856) rotate(0 128 128)"><path d="M1.55 -1.38 C76.42 3.43, 153.15 2.19, 257.31 0.47 M0.03 0.25 C76.91 -1.54, 154.52 -1.19, 255.76 -0.2 M255.94 -1.42 C255.74 88.91, 256.1 177.98, 254.85 254.86 M255.45 0.59 C257.17 80.26, 256.3 161.27, 255.31 255.54 M256.43 256.8 C204.74 256.28, 153.21 256.29, 0.55 255.5 M256.58 256.34 C169.7 256.82, 82.25 257.93, -0.08 256.17 M0.31 256.2 C3.02 204.08, 0.82 149.59, -0.38 -1.22 M-0.1 256.3 C0.08 183.7, -0.56 110.59, 0.22 0.04" stroke="#000000" stroke-width="1" fill="none"></path></g><g stroke-linecap="round"><g transform="translate(78.58900090233897 295.51447543435376) rotate(317.0168529739978 141.99923395634164 0.05388891398906992)"><path d="M1.15 -1.02 C48.25 -0.65, 236.62 0.93, 283.7 1.13 M0.29 1.05 C47.11 1.22, 235.54 -0.5, 282.6 -0.4" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(78.58900090233897 295.51447543435376) rotate(317.0168529739978 141.99923395634164 0.05388891398906992)"><path d="M252.75 9.49 C267.52 5.02, 277.08 3.16, 283.18 -0.38 M254.77 9.9 C259.6 8.4, 266.2 5.12, 282.35 0.08" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(78.58900090233897 295.51447543435376) rotate(317.0168529739978 141.99923395634164 0.05388891398906992)"><path d="M252.66 -11.03 C267.28 -7.42, 276.88 -1.2, 283.18 -0.38 M254.68 -10.62 C259.6 -7.62, 266.23 -6.39, 282.35 0.08" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g transform="translate(103.56038955661438 260.8248270978168) rotate(317.0168529739978 112.5 13)"><text x="0" y="18" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr">User allows application</text></g><g transform="translate(164.07132007619464 302.97372824816455) rotate(317.0168529739978 73.5 13)"><text x="0" y="18" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr">to spend token</text></g><g stroke-linecap="round" transform="translate(308.9467208795156 48) rotate(0 87 87)"><path d="M87.4 0.36 C107.87 18.66, 124.72 35.36, 174.71 88.07 M88.71 -0.57 C116.14 29.77, 145.4 59.7, 173.53 87.96 M172.78 88.13 C153.6 104.83, 137.08 125.16, 86.37 172.63 M173.52 88.01 C141.54 119.16, 109.28 151.08, 87.87 174.26 M87.72 174.69 C57.92 143.62, 27.26 115.23, 1.18 89.44 M87.84 174.88 C57.25 144.36, 26.34 113.8, -0.83 88.19 M-1.36 88.47 C26.4 58.21, 54.01 32.92, 89.51 -0.25 M0.16 87.91 C29.09 57.99, 57.55 28.1, 88.06 -0.91" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(321.9467208795156 10) rotate(0 77.5 13)"><text x="0" y="18" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr">Token Contract</text></g><g stroke-linecap="round"><g transform="translate(159.94672087951562 526) rotate(0 141.6081674941676 0.8108442932457649)"><path d="M0.21 0.97 C47.42 1.03, 237.21 0.1, 284.35 0.01 M-1.13 0.44 C45.84 0.74, 235.83 1.91, 283.58 1.55" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(159.94672087951562 526) rotate(0 141.6081674941676 0.8108442932457649)"><path d="M257.01 12.38 C266.55 6.1, 278.36 3.73, 284.21 1.39 M255.1 11.55 C261.43 10.44, 266.13 7.82, 282.71 0.72" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(159.94672087951562 526) rotate(0 141.6081674941676 0.8108442932457649)"><path d="M257.02 -8.14 C266.49 -6.33, 278.3 -0.61, 284.21 1.39 M255.11 -8.97 C261.58 -5.98, 266.28 -4.49, 282.71 0.72" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g transform="translate(195.94672087951562 488) rotate(0 102 13)"><text x="0" y="18" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr">Users tells contract</text></g><g transform="translate(237.94672087951562 537) rotate(0 51 13)"><text x="0" y="18" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr">to deposit</text></g><g stroke-linecap="round"><g transform="translate(585.1143073428149 327.7441165285062) rotate(5.553570904722957 -64.70393416405193 -63.90926006727386)"><path d="M0.01 -0.97 C-21.6 -22.52, -107.23 -107.61, -128.69 -128.96 M-1.45 1.14 C-23.26 -20.23, -108.11 -105.91, -129.42 -127.4" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(585.1143073428149 327.7441165285062) rotate(5.553570904722957 -64.70393416405193 -63.90926006727386)"><path d="M-28.82 -12.86 C-16.74 -8.14, -6.59 -5.96, 1.42 -2.11 M-26.69 -14.04 C-19.91 -11.16, -13.33 -6.89, -0.6 -0.9" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(585.1143073428149 327.7441165285062) rotate(5.553570904722957 -64.70393416405193 -63.90926006727386)"><path d="M-14.35 -27.41 C-7.74 -17.15, -3.1 -9.42, 1.42 -2.11 M-12.22 -28.59 C-9.4 -21.7, -6.74 -13.49, -0.6 -0.9" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(585.1143073428149 327.7441165285062) rotate(5.553570904722957 -64.70393416405193 -63.90926006727386)"><path d="M-103.89 -113.9 C-112.59 -118.85, -123.16 -126.35, -128 -128.55 M-101.76 -115.08 C-109.64 -118.82, -117.78 -121.43, -130.03 -127.34" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(585.1143073428149 327.7441165285062) rotate(5.553570904722957 -64.70393416405193 -63.90926006727386)"><path d="M-118.47 -99.45 C-121.66 -109.91, -126.66 -122.92, -128 -128.55 M-116.33 -100.63 C-120.23 -108.35, -124.42 -114.87, -130.03 -127.34" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g transform="translate(484.8543451611646 235.24873583626623) rotate(50.5535709047229 107 25.5)"><text x="0" y="18.5" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr">Contract sends token</text><text x="0" y="44" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr">from user to itself</text></g><g transform="translate(511.51814945094407 495.57142857142856) rotate(0 100 13)"><text x="0" y="18" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr">Application Contract</text></g><g transform="translate(144.94672087951562 212) rotate(0 23 18)"><text x="0" y="25" font-family="Virgil, Segoe UI Emoji" font-size="28px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr">Tx1</text></g><g transform="translate(288.2800542128489 433.9444444444445) rotate(0 29 18)"><text x="0" y="25" font-family="Virgil, Segoe UI Emoji" font-size="28px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr">Tx2</text></g><g transform="translate(173.0538637366593 716.2738095238096) rotate(0 239 18)"><text x="239" y="25" font-family="Virgil, Segoe UI Emoji" font-size="28px" fill="#000000" text-anchor="middle" style="white-space: pre;" direction="ltr">Each application must be approved</text></g></svg>


### Wrapped model

The user approves the wrapped deposit contract to spend tokens on their behalf. Then the user asks the wrapped deposit contract to deposit to an application on their behalf. Only the wrapped deposit contract needs to be approved to spend tokens. The wrapped deposit contract can send tokens to any number of application contracts.

<svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1288.764634260725 869.7738095238092" width="700">
  <defs>
    <style>
      @font-face {
        font-family: "Virgil";
        src: url("https://plus.excalidraw.com/Virgil.woff2");
      }
      @font-face {
        font-family: "Cascadia";
        src: url("https://plus.excalidraw.com/Cascadia.woff2");
      }
    </style>
  </defs>
  <rect x="0" y="0" width="1288.764634260725" height="869.7738095238092" fill="#ffffff"></rect><g stroke-linecap="round" transform="translate(29.911459657549813 401.46825396825403) rotate(0 37.5 37.5)"><path d="M36.32 0.05 C43.54 -0.44, 53.29 3.08, 59.5 7.34 C65.72 11.61, 71.44 18.72, 73.61 25.66 C75.77 32.59, 74.98 41.73, 72.51 48.96 C70.04 56.19, 64.81 64.78, 58.8 69.05 C52.78 73.33, 44.03 74.88, 36.42 74.59 C28.82 74.3, 18.95 72.02, 13.17 67.33 C7.39 62.63, 3.45 53.93, 1.77 46.42 C0.09 38.9, 0.23 29.23, 3.09 22.26 C5.95 15.28, 12.41 8.31, 18.92 4.55 C25.43 0.79, 37.54 0.3, 42.15 -0.32 C46.77 -0.95, 46.95 0.1, 46.6 0.79 M55.87 3.94 C62.59 6.96, 69.8 14.77, 72.81 21.67 C75.83 28.58, 75.79 37.81, 73.96 45.35 C72.13 52.88, 67.41 62.16, 61.84 66.88 C56.26 71.61, 47.72 73.5, 40.53 73.72 C33.35 73.95, 25.14 71.8, 18.75 68.24 C12.35 64.68, 5.17 59.1, 2.15 52.37 C-0.87 45.64, -1.63 35.5, 0.61 27.84 C2.85 20.17, 9.72 10.84, 15.62 6.38 C21.52 1.92, 29.41 1.58, 36 1.09 C42.6 0.6, 52.11 2.57, 55.19 3.44 C58.27 4.32, 54.73 5.86, 54.49 6.33" stroke="#000000" stroke-width="1" fill="none"></path></g><g stroke-linecap="round"><g transform="translate(66.91145965754981 477.46825396825403) rotate(0 -0.8690750205803397 58.504170860489836)"><path d="M-0.03 -0.06 C-0.08 19.46, -0.44 97.4, -0.48 117.09 M-1.5 -1.14 C-1.74 18.5, -1.73 98.06, -1.68 118.15" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g transform="translate(67.91145965754981 591.4682539682541) rotate(0 -28.986386749148323 28.174389238050196)"><path d="M-0.06 -0.48 C-9.71 8.98, -48.43 47.09, -57.91 56.73 M-1.55 -1.78 C-10.83 7.86, -46.32 48.63, -55.68 58.13" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g transform="translate(67.91145965754981 593.4682539682541) rotate(0 26.12523185908799 26.84775258779061)"><path d="M-0.48 -0.91 C8.31 7.94, 43.76 43.98, 52.73 53.05 M1.47 1.22 C10.08 10.29, 43.09 46.24, 51.64 54.61" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g transform="translate(68.91145965754981 528.4682539682541) rotate(0 -21.533810294410273 -13.433272985597142)"><path d="M-0.91 -0.27 C-8.06 -4.3, -36.02 -20.61, -42.95 -24.66 M0.81 -1.46 C-6.49 -5.82, -36.58 -22.4, -43.88 -26.6" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g transform="translate(69.91145965754981 528.4682539682541) rotate(0 31.037618276476906 -9.158725985293273)"><path d="M-0.27 0.05 C10.2 -2.55, 51.89 -13.58, 62.34 -16.5 M1.79 -0.98 C12.18 -3.86, 51.55 -15.79, 61.58 -18.36" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round" transform="translate(700.5265390226286 56.07142857142851) rotate(0 82.5 82.5)"><path d="M83.97 1.51 C102.72 20.33, 126.48 43.97, 165.33 83.03 M83.9 -0.51 C105.43 21.22, 125.3 43.81, 165.97 83.26 M166.95 83.41 C143.96 104.58, 122.34 127.02, 82.75 163.48 M165.86 82.48 C134.22 113.91, 102.52 143.05, 83.72 165.19 M83.76 163.18 C62.1 147.47, 41.75 127.43, 1.87 83.23 M82.94 165.41 C54.04 136.8, 23.84 107.84, 0.78 82.53 M0.49 81.84 C28.31 56.29, 57.61 29.19, 83.19 -0.35 M0.68 82.98 C28.77 53.83, 57.99 24.15, 83.58 0.7" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(699.6932056892952 10) rotate(0 87 13)"><text x="0" y="18" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr">Wrapper Contract</text></g><g stroke-linecap="round" transform="translate(304.88368187977176 56.9285714285714) rotate(0 87 87)"><path d="M86.16 0.81 C110.34 25.51, 132.85 48.91, 174.74 86.47 M87.47 0.76 C107.13 19.97, 128.75 40.17, 173.52 87.77 M172.47 86.41 C153.27 109.73, 131.18 131.72, 86.98 173.78 M174.73 88.53 C154.25 106.9, 134.65 128.62, 88.89 173.66 M88.39 172.87 C57.04 141.67, 24.75 112.33, 1.78 87.58 M87.91 174.27 C59.2 145.56, 29.31 116.69, -0.58 87.7 M-1.52 89.39 C21.69 68.14, 40.8 47.17, 86.02 2 M-0.51 87.84 C27.94 61.8, 54.78 33.34, 88.28 -0.6" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(314.13368187977176 10.178571428571374) rotate(0 77.5 13)"><text x="0" y="18" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr">Token Contract</text></g><g stroke-linecap="round" transform="translate(1021.8003485464396 603.7738095238092) rotate(0 128 128)"><path d="M0.77 -0.06 C60.81 2.54, 125.49 1.78, 256.45 -0.16 M-0.06 -0.8 C51 -0.44, 102.95 0.22, 255.38 -0.04 M257.12 0.76 C255.15 84.95, 254.64 166.63, 255.78 254.78 M255.28 -0.49 C254.82 54.62, 254.39 108.49, 255.4 256.28 M256.3 256.52 C162.34 258.26, 69.69 256, -0.1 255.99 M255.9 255.77 C189.03 257.52, 120.69 258.11, 0.28 256.5 M-0.05 254.99 C-1.56 191.02, -2.71 127.27, 1.11 0.76 M0.77 255.65 C-0.83 171.99, -0.1 87.81, -0.05 0" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(1049.8003485464396 720.2023809523807) rotate(0 100 13)"><text x="0" y="18" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr">Application Contract</text></g><g stroke-linecap="round"><g transform="translate(74.55034854643918 292.5674341144421) rotate(317.0168529739978 142.45326222629285 -0.13824476526785645)"><path d="M0.94 0.32 C48.26 0.4, 235.78 -0.78, 282.84 -0.72 M-0.03 -0.55 C47.74 -0.24, 237.3 0.56, 284.94 0.43" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(74.55034854643918 292.5674341144421) rotate(317.0168529739978 142.45326222629285 -0.13824476526785645)"><path d="M257.27 8.72 C261.47 7.15, 269.65 4.68, 286.56 1.03 M256.89 10.84 C263.01 8.97, 269.26 4.82, 285.53 -0.01" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(74.55034854643918 292.5674341144421) rotate(317.0168529739978 142.45326222629285 -0.13824476526785645)"><path d="M257.3 -11.8 C261.3 -9.12, 269.47 -7.34, 286.56 1.03 M256.92 -9.68 C262.95 -6.77, 269.19 -6.14, 285.53 -0.01" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g transform="translate(103.414200243697 267.76364232680925) rotate(317.0168529739978 98 13)"><text x="0" y="18" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr">User allows wrapper</text></g><g transform="translate(160.03266772029497 300.0266869282529) rotate(317.0168529739978 73.5 13)"><text x="0" y="18" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr">to spend token</text></g><g transform="translate(140.90806852361584 209.05295868008835) rotate(0 29 18)"><text x="0" y="25" font-family="Virgil, Segoe UI Emoji" font-size="28px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr">Tx0</text></g><g transform="translate(316.12177711786717 433.0595238095239) rotate(0 107 25.5)"><text x="0" y="18.5" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr">User tells wrapper to</text><text x="0" y="44" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr">deposit to application</text></g><g stroke-linecap="round" transform="translate(1022.2289199750107 312.2738095238096) rotate(0 128 128)"><path d="M0.46 -1.39 C93.45 1.85, 188.58 1.11, 256.55 0.33 M0.79 0.79 C73.28 1.72, 146.06 1.36, 255.6 -0.67 M257.35 1.3 C255.11 56.54, 255.93 114.15, 255.39 254.56 M255.52 -0.34 C254.04 71.03, 254.87 143.68, 256.47 256.59 M254.44 254.53 C195.53 257.85, 131.94 255.94, -0.21 256.34 M255.91 256.09 C194.72 258.67, 133.28 258.66, 0.61 256.5 M-0.53 257.6 C-2.13 169.2, -2.05 81.93, -0.65 -1.33 M0.39 256.45 C-1.99 197.66, -1.53 140.18, 0.39 -0.01" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(1050.2289199750107 427.27380952380946) rotate(0 100 13)"><text x="0" y="18" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr">Application Contract</text></g><g stroke-linecap="round" transform="translate(1022.764634260725 22.809523809523753) rotate(0 128 128)"><path d="M0.91 1.38 C102.82 1.14, 203.9 0.77, 256.6 1.39 M-0.18 -0.23 C58.45 -2.76, 116.85 -2.72, 255.41 0.61 M255.13 -0.37 C257.03 95.2, 257.76 188.41, 255.77 257.2 M256.51 0.39 C257.85 94.23, 258 187.46, 256.19 255.83 M255.4 254.9 C172.8 254.39, 87.3 256.22, 0.76 257.5 M255.91 256.78 C189.46 256.18, 122.65 256.46, -0.66 256.09 M-1.45 256.95 C0.52 203.96, -0.53 152.5, -0.14 0.76 M-0.02 256.63 C-0.38 156.11, 0.76 57.14, 0.63 -0.41" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(1050.764634260725 137.80952380952368) rotate(0 100 13)"><text x="0" y="18" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr">Application Contract</text></g><g stroke-linecap="round"><g transform="translate(152.01463426072337 521.8809523809525) rotate(0 280.9562305207171 -164.4955520421267)"><path d="M-1.08 0.92 C92.4 -54.12, 466.86 -274.93, 560.68 -329.91 M0.55 0.35 C94.43 -54.49, 469.55 -273.14, 562.99 -328.32" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(152.01463426072337 521.8809523809525) rotate(0 280.9562305207171 -164.4955520421267)"><path d="M545.39 -306.46 C549.4 -311, 556.44 -316.82, 563.18 -328.98 M543.61 -304.66 C549.27 -311.66, 553.3 -316.16, 563.77 -329.17" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(152.01463426072337 521.8809523809525) rotate(0 280.9562305207171 -164.4955520421267)"><path d="M535.01 -324.17 C542.02 -323.58, 552.01 -324.37, 563.18 -328.98 M533.24 -322.37 C541.62 -324.65, 548.36 -324.53, 563.77 -329.17" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g transform="translate(486.3003485464369 143.30952380952397) rotate(0 105.78569246496932 -1.9245532508407273)"><path d="M0.5 0.68 C36.01 0.07, 177.07 -3.52, 212.27 -4.53 M-0.7 0 C34.79 -0.36, 176.47 -2.35, 211.76 -3.13" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(486.3003485464369 143.30952380952397) rotate(0 105.78569246496932 -1.9245532508407273)"><path d="M29.58 -8.84 C21.36 -7.13, 13.33 -3.81, 0.91 1.42 M28.76 -9.64 C20.79 -7.26, 14.36 -3.93, 0.28 1" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(486.3003485464369 143.30952380952397) rotate(0 105.78569246496932 -1.9245532508407273)"><path d="M30.07 11.67 C21.88 8.55, 13.73 7.04, 0.91 1.42 M29.25 10.87 C21.11 8.12, 14.55 6.32, 0.28 1" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(486.3003485464369 143.30952380952397) rotate(0 105.78569246496932 -1.9245532508407273)"><path d="M184.9 9.02 C190.02 5.39, 195.16 3.61, 212.18 -2.39 M184.08 8.22 C190.06 4.92, 197.63 2.82, 211.55 -2.82" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(486.3003485464369 143.30952380952397) rotate(0 105.78569246496932 -1.9245532508407273)"><path d="M184.54 -11.49 C189.6 -10.29, 194.84 -7.24, 212.18 -2.39 M183.72 -12.29 C189.85 -10.47, 197.51 -7.43, 211.55 -2.82" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g transform="translate(206.94320568929402 494.30952380952385) rotate(0 29.5 23)"><text x="29.5" y="32" font-family="Virgil, Segoe UI Emoji" font-size="36px" fill="#000000" text-anchor="middle" style="white-space: pre;" direction="ltr">Tx1</text></g><g transform="translate(104.01463426072269 701.5952380952383) rotate(0 270.5 18)"><text x="270.5" y="25" font-family="Virgil, Segoe UI Emoji" font-size="28px" fill="#000000" text-anchor="middle" style="white-space: pre;" direction="ltr">Only the wrapper needs to be approved</text></g><g stroke-linecap="round"><g transform="translate(876.7765390226286 140.92857142857173) rotate(0 63.26879990135376 -0.6108856537512306)"><path d="M-0.1 0.55 C21.36 0.16, 106.9 -1.39, 128.15 -1.77 M-1.62 -0.2 C19.7 -0.47, 105.09 -0.34, 126.99 -0.42" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(876.7765390226286 140.92857142857173) rotate(0 63.26879990135376 -0.6108856537512306)"><path d="M99.73 9.17 C105.18 5.44, 112.18 6.03, 125.28 0.11 M98.66 9.2 C109.06 6.48, 120.18 1.33, 126.44 -1.28" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(876.7765390226286 140.92857142857173) rotate(0 63.26879990135376 -0.6108856537512306)"><path d="M99.71 -11.35 C105.27 -9.98, 112.26 -4.29, 125.28 0.11 M98.64 -11.32 C109.16 -6.41, 120.28 -3.95, 126.44 -1.28" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g transform="translate(838.2051104512002 176.64285714285745) rotate(0 77.17320355755078 145.85222361667797)"><path d="M-0.38 0.35 C-2.06 44.82, -37.87 219.64, -9.13 266.82 C19.62 314, 141.66 280.53, 172.1 283.43 M1.62 -0.51 C-0.22 43.65, -38.45 217.82, -9.62 265.28 C19.21 312.75, 143.98 280.97, 174.6 284.29" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(838.2051104512002 176.64285714285745) rotate(0 77.17320355755078 145.85222361667797)"><path d="M147.79 297.98 C159.35 290.75, 166.37 288.52, 174.4 283.19 M147.91 296.67 C153.91 293.26, 161.6 289.57, 173.63 285.01" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(838.2051104512002 176.64285714285745) rotate(0 77.17320355755078 145.85222361667797)"><path d="M146.33 277.51 C158.44 277.98, 166.01 283.44, 174.4 283.19 M146.46 276.2 C152.89 278.36, 160.98 280.23, 173.63 285.01" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g transform="translate(846.7765390226286 173.78571428571462) rotate(0 57.45139157590529 307.92003658020593)"><path d="M0.04 0.55 C-6.16 94.22, -62.9 462.62, -36.51 561.77 C-10.13 660.92, 126.03 589.92, 158.34 595.42 M-1.4 -0.21 C-7.28 93.59, -60.82 463.27, -34.22 562.74 C-7.62 662.2, 126.21 591.14, 158.21 596.58" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(846.7765390226286 173.78571428571462) rotate(0 57.45139157590529 307.92003658020593)"><path d="M133.18 610.33 C139.73 608.28, 150.29 601.32, 156.65 596.62 M133.03 612.57 C139.88 607.75, 145.72 602.75, 158.41 595.82" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(846.7765390226286 173.78571428571462) rotate(0 57.45139157590529 307.92003658020593)"><path d="M129.56 590.13 C137.35 595.28, 149.21 595.51, 156.65 596.62 M129.41 592.37 C137.39 593.11, 144.22 593.67, 158.41 595.82" stroke="#000000" stroke-width="1" fill="none"></path></g></g></svg>

## Advantages

#### Fewer transactions

Users only need to approve a token to be spent once.

#### More safe

Users only need to approve one contract to spend their tokens. They don't need to trust application contracts with token spend approvals.

The wrapped deposit contract is short and simple (less than 50 lines of code) and therefore less likely to contain exploits.

#### Developer friendly

The wrapped deposit contract offers a simple way for application programmers to handle deposits of Ether and tokens without needing to interface with the token contract.

## Application Contract Usage

To accept deposits an application contract should implement the `DepositReceiver` interface. This consists of a single function `acceptDeposit(depositor, token, amount)`. This function should revert if the deposit is not accepted. If the function does not revert the funds will either be transferred, or the transaction will revert. An example implementation is shown below:

```js
contract MyApplication implements DepositReceiver {
  address constant ALLOWED_DEPOSIT_TOKEN = address(0);
  mapping (address => uint) balanceOf;

  function acceptDeposit(address depositor, address token, uint amount) public {
    require(token == ALLOWED_DEPOSIT_TOKEN, "Invalid deposit asset")
    balanceOf[depositor] += amount;
  }
}
```
